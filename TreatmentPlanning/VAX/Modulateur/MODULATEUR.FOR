C-------------------------------------------------------------------------------
C       PROGRAMME D'INTERROGATION DU FICHIER DE LA BIBLIOTHEQUE DES
C	MODULATEURS EXISTANTS AVANT LA CREATION D'UN NOUVEAU MODULATEUR.
C			
C				MODULATEUR.FOR	J.HERAULT    10-01-92
C-------------------------------------------------------------------------------

	DIMENSION PARCOURS(200),MODULATION98(200),MODULATION100(200)
	DIMENSION SOLU(10),SSOLU(10),SSSSOLU(10)
     	DIMENSION SSSOLU(10),NUMERO(200)
	REAL*4 PARCOURS,XEPS,MODULATION98,MODULATION100,PARC,MODU,XXEPS,R_MES
	INTEGER*2 N,MK,NUMERO*4
	CHARACTER*5 SOLU,SSOLU,SSSOLU,SSSSOLU
	N=0
	OPEN (UNIT=20,FILE='[JOEL.ALPHA.BRAGG.DABRAG]MODU_92.DAT',STATUS='OLD')
	READ (20,*)
	DO I=1,200
		READ (20,5,END=12) MODULATION100(I),MODULATION98(I),PARCOURS(I),
     &		NUMERO(I)
	        MK=I
	END DO
 12	CONTINUE
  5	FORMAT (F5.1,10X,F5.1,10X,F5.1,4X,4I)
	OPEN (UNIT=10,FILE='NUMES.DAT',STATUS='NEW')
	WRITE (*,*) 'ENTRER LA MODULATION SOUHAITEE:'
	READ (*,*) MODU
	WRITE (*,*) 'ENTRER LE PARCOURS SOUHAITE:'
	READ (*,*) PARC
	DO I=1,MK
		XEPS=ABS(MODULATION100(I)-MODU)
		XXXEPS=MODULATION98(I)-MODU
		XXEPS=ABS(PARCOURS(I)-PARC)
		IF (((XEPS.LT.0.5).OR.((XXXEPS.GE.-0.1).AND.(XXXEPS.LE.0.5)))
     &		.AND.(XXEPS.LT.3.))THEN
			N=N+1
			WRITE (SOLU(N),10) PARCOURS(I)
			WRITE (SSOLU(N),10) MODULATION100(I)
			WRITE (SSSOLU(N),10) MODULATION98(I)
			WRITE (SSSSOLU(N),15) NUMERO(I)
		END IF
	END DO
	RANGE_S=(-PARC+30.65)*1.05/1.18
	R_MES=-2+(PARC-MODU/2.)*1.05/1.18
!	-2mm offset epaisseur chambre
  10 	FORMAT (F5.1)
  15	FORMAT (I5)
	IF (N.EQ.0) THEN
		WRITE (*,*) 'AUCUN MODULATEUR DISPONIBLE A 0.4 PRES'
	ELSE
		WRITE (*,*) 'MODULATION PROPOSEE A 0.4 PRES, POUR UN'
		WRITE (*,*) 'PARCOURS A 3 PRES:'
		WRITE (*,*) ' '
		WRITE (*,*) 'MODULATION100 MODULATION98 PARCOURS NUMERO'
		DO I=1,N
			WRITE (*,20) SSOLU(I),SSSOLU(I),SOLU(I),SSSSOLU(I)
			WRITE (10,30) SSSSOLU(I)
		END DO
		WRITE (*,25) RANGE_S,R_MES
	END IF
  20			FORMAT (A5,T15,A5,T28,A5,T38,A5)
  30	FORMAT (A5)
  25	FORMAT (' EP DEGRADEUR PLEXI= ',F5.1,' EP MESURE PLEXI= ',F5.1)	
	END
     	
